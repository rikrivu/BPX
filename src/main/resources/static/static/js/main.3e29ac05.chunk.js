(this["webpackJsonpbpx-frontend"]=this["webpackJsonpbpx-frontend"]||[]).push([[0],{125:function(e,t){},144:function(e,t){},188:function(e,t,n){},189:function(e,t,n){},190:function(e,t,n){},195:function(e,t,n){},196:function(e,t,n){},205:function(e,t,n){},207:function(e,t,n){},208:function(e,t,n){},209:function(e,t,n){},214:function(e,t){},215:function(e,t){},254:function(e,t,n){},255:function(e,t,n){},257:function(e,t,n){},258:function(e,t,n){"use strict";n.r(t);var r=n(2),a=n(30),i=n.n(a),o=(n(188),n(85)),c=n(24),s=(n(189),n(190),n(292)),l=n(3);var u=function(){return Object(l.jsx)("div",{className:"loader-wrapper",children:Object(l.jsx)(s.a,{})})},d=n(12),b=n(25),f={isLoading:!1,tableLoading:!0,showNotifier:{show:"initial",type:null}},j=Object(r.createContext)(f),p=j.Provider,A=function(e){var t=e.children,n=Object(r.useReducer)((function(e,t){var n=Object(d.a)({},e);return t.forEach((function(e){n[e.type]=e.data})),n}),f),a=Object(b.a)(n,2),i=a[0],o=a[1];return Object(l.jsx)(p,{value:{state:i,dispatch:o},children:t})};n(195),n(196);var h=function(e){return e.options.length?Object(l.jsx)("div",{onChange:e.handleRadioButtonToggle,className:"radio-btn-wrapper",children:e.options.map((function(t){return Object(l.jsxs)("div",{children:[Object(l.jsx)("input",{id:t.id,type:"radio",className:"radio-input",name:"permit",value:t.name,defaultChecked:e.selected===t.name}),Object(l.jsx)("label",{htmlFor:t.id,children:t.name})]},t.id)}))}):Object(l.jsx)("div",{children:"No Option to show for Radio Group"})},m="http://localhost:8085/api/",O=[{name:"Air Permit",id:"Air_Permit"},{name:"Storm Water Permit",id:"Storm_Water_Permit"},{name:"Injection Well Permit",id:"Injection_Well_Permit"},{name:"Water Wells/Reservoirs Permits",id:"Water_Reservoir_Permit"},{name:"EPA Class V Cathodic Protection",id:"EPA_Class_V_Cathodic_Protection"},{name:"North & South Evap. Ponds",id:"North_&_South_Evap._Ponds"}],g=n(58),v=n(91);n(202),n(203);var x=function(e){return Object(l.jsx)("div",{children:e.value?e.value:"---"})},C=n(35),w=n.n(C),y=n(59),I=new AbortController,B=new AbortController,S=function(){var e=Object(y.a)(w.a.mark((function e(t,n){var r;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return I.abort(),I=new AbortController,e.next=4,fetch(m+"facilities?page="+n.page+"&size=30&sortBy="+n.criteria+"&order="+n.state+"&filter="+t,{signal:I.signal});case 4:return r=e.sent,e.next=7,r.json();case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),N=function(){var e=Object(y.a)(w.a.mark((function e(t,n){var r;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(m+"permit?sortBy="+n.criteria+"&order="+n.state+"&facilityId="+t);case 2:return r=e.sent,e.next=5,r.json();case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),k=function(){var e=Object(y.a)(w.a.mark((function e(t,n){var r;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(m+"download/permit?facilityId="+t+"&permitId="+n);case 2:return r=e.sent,e.abrupt("return",r);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),R=function(){var e=Object(y.a)(w.a.mark((function e(t){var n;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(m+"download/application?fileName="+t);case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),D=function(){var e=Object(y.a)(w.a.mark((function e(t){var n;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return B.abort(),B=new AbortController,e.next=4,fetch(m+"list/file?facilityId="+t,{signal:B.signal});case 4:return n=e.sent,e.next=7,n.json();case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),F=function(e,t){var n=Object(d.a)(Object(d.a)({},t),{},{sortFilterState:Object(d.a)(Object(d.a)({},t.sortFilterState),{},{criteria:e})});if(t.sortFilterState.criteria===e)switch(t.sortFilterState.state){case"ASC":n.sortFilterState.state="DESC";break;case"DESC":n.sortFilterState.state="ASC"}else n.sortFilterState.state="DESC";return n},P=function(e,t){e([{type:"isLoading",data:!1},{type:"showNotifier",data:{show:"start",type:t}}]),setTimeout((function(){e([{type:"showNotifier",data:{show:"end",type:t}}])}),3e3)},E=n(75),L=n(302),T=Object(E.a)((function(e){return{tooltip:{backgroundColor:e.palette.common.white,color:"rgba(0, 0, 0, 0.87)",boxShadow:e.shadows[1],fontSize:11}}}))(L.a);var Q=function(e){var t=Object(r.useContext)(j).dispatch,n="";return e.data.facilityId&&e.value?Object(l.jsx)(T,{title:"Open Permit",children:Object(l.jsx)("button",{type:"button",className:"link-btn no-truncate",onClick:function(){return r=e.data.facilityId,a=e.value,t([{type:"isLoading",data:!0}]),void k(r,a).then((function(e){return console.log("res from URLRenderer",e),n=e.headers.get("Content-Disposition").replace("attachment; filename=: ",""),e.blob()})).then((function(e){if("application/pdf"===e.type){var r=new Blob([e],{type:"application/pdf"}),a=URL.createObjectURL(r);window.open(a)}else{var i,o=URL.createObjectURL(new Blob([e])),c=document.createElement("a");c.href=o,c.setAttribute("download",n),document.body.appendChild(c),c.click(),null===(i=c.parentNode)||void 0===i||i.removeChild(c)}t([{type:"isLoading",data:!1}])})).catch((function(e){console.log("Unable to retrieve file",e),P(t,"fail")}));var r,a},children:e.value})}):e.value?e.value:"---"};var U,M=function(e){return e.value?Object(l.jsx)("div",{children:Object(l.jsx)(T,{title:"View Permits for this Facility",children:Object(l.jsx)("a",{href:"permits/".concat(e.value),children:e.value})})}):"---"},W=function(){var e=Object(r.useState)(!1),t=Object(b.a)(e,2),n=t[0],a=t[1],i=Object(r.useState)("I'm the Modal Content"),o=Object(b.a)(i,2),c=o[0],s=o[1];return{isModalActive:n,toggleModal:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];a(!n),e&&s(e)},modalContent:c}},H=(n(205),n(70)),Y=n.n(H),V=function(e){var t=Object(r.useContext)(U),n=t.modalContent,a=t.toggleModal,o=t.isModalActive,c=Object(l.jsx)("div",{className:"modal-container",children:Object(l.jsxs)("div",{children:[e.showClearModal?Object(l.jsx)("div",{className:"modal-clear-container",children:Object(l.jsx)("button",{type:"button",className:"modal-clear-button",onClick:function(){return a()},children:Object(l.jsx)(Y.a,{})})}):null,n]})});return o?i.a.createPortal(c,document.querySelector("#modal-root")):null},z=(U=Object(r.createContext)(null)).Provider,J=function(e){var t=e.children,n=e.showClearModal,r=void 0===n||n,a=W(),i=a.isModalActive,o=a.toggleModal,c=a.modalContent;return Object(l.jsxs)(z,{value:{isModalActive:i,toggleModal:o,modalContent:c},children:[Object(l.jsx)(V,{showClearModal:r}),t]})},Z=(n(207),n.p+"static/media/excel-icon.8217b42c.png"),G=n.p+"static/media/json-icon.a60aa82b.png";var X=function(e){var t=Object(r.useState)([]),n=Object(b.a)(t,2),a=n[0],i=n[1],o=Object(r.useContext)(U).toggleModal,c=Object(r.useContext)(j),s=c.dispatch,u="";return Object(r.useEffect)((function(){s([{type:"isLoading",data:!0}]),i([]),D(e.facilityId).then((function(e){i(Object(g.a)(e)),s([{type:"isLoading",data:!1}])})).catch((function(e){console.log("Some error Occured",e),s([{type:"isLoading",data:!1}])}))}),[s,e.facilityId]),Object(l.jsx)("div",{className:"file-view-container",children:Object(l.jsxs)("div",{children:[Object(l.jsxs)("div",{className:"modal-header",children:[Object(l.jsxs)("div",{children:["Files for ",e.applicationNumber]}),Object(l.jsx)(T,{title:"Close",children:Object(l.jsx)("button",{type:"button",className:"modal-clear-button",onClick:function(){return o()},children:Object(l.jsx)(Y.a,{})})})]}),Object(l.jsx)("div",{className:"modal-body app-scroll",children:c.state.isLoading?null:a.length?a.map((function(e,t){return Object(l.jsxs)("div",{className:"pdf-link",children:[e.includes(".pdf")?Object(l.jsx)("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABMAAAAZCAYAAADTyxWqAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAH1SURBVHgBpZVBbtNQEIZn3nNoVCmVo4S92SFKkFmguqu6JyjcoD1BwwlKTtDkBMAJYk6Q7EjZYGhZ4x0S0NobwKH4DfMeRIrT1qmdT7Lm+Vn6PfP+8Ri/Pnng1oT1kpBcuC2IIa6J3eY4THL7sdcZnW9vdm+r893r7F9sdeKL7UfvY9+1558JAnDWUQ2hBIgQEKk3NFWjeUEBFWlNzl4sClYS09VcJ2hBSWQqA6pnRzGfGRAZA4jIpTQblhZrhsbBe9+8h/5sDxUOhIDj0mIz7k7OxrN17LkOQQaFYp99x96YNo70WqzJ3pW+WqDQgEbaeCoUOPpS08t9WEJhZgjgK6QP5obQhiUUZsYtMEbAHcEXKQxhFbH25PQVBz5c8OW6HMMqYiY7UgMdL3/8dlYWEyj2kCCwLDma763rKDTgi3fflJgh7VqEiQQcceeHfJg2u5MogNettx/7SzPTPVbHO4d6LQmH/MnYRPj8X1QJxwRJ7RVmpkXsdOOQflGXB6bNbz9onxgjZvTPtza7XPoOKqt3o5ieulYqhwQq4qQjBAr/O5qjdfJJl9Zf3M+VWZPy2PQWihA4Ky6wByXIiWUKBsjjRIFCrMvHzUkYQQlyZbbfnQYcAqhI5bF9k1j0k2rPYBVMi1CExkEp9d/JgaoghfjHOvgLjITb6sxwDOYAAAAASUVORK5CYII=",alt:"pdf-icon.png"}):e.includes(".docx")?Object(l.jsx)("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAEACAMAAABrrFhUAAAAe1BMVEUAAAAhHh4gHBzy8fErV5gpVZgpVZgpVZgoVJkpVZgoVZolO1+PjIwnRXX///8pVZiXl5elo6RoZmfK1eZdf7GTqcx4lL5DaaRQdKvy9Pmgs9Nribfl6/Ouvtm6yt88YJjX3+w1X55YcphFZpiPkpd8h5d0gpdgdpeFnsRG668zAAAADnRSTlMAZkDpL++/r39vP5bYslFH3mcAAASFSURBVHja7NdLTsNAEEXRAOGb0I7DbwJC4rv/HZJBLIWO7W5LgarUu3cF9c6oe0ZERERERERERJWd2HQ681LlwXEFag8OK7A5Jf13bbv0I2AD0J65ETACSG4ErADcCFgBuBEwA/AiYAfgRMAQwIeAJYALAVMADwK2AA4EjAHsBcwBJgoEBJgmEBFgkkBIgCkCMQEmCAQFqBeICmAgMAaw+tvW63VyI+AGoFIgMECdQGSAKoHQADUCsQEqBIIDlAWiAxQFwgOUBYK+BLtKAgIA4wIKAKMCEgBjAhoAIwIiAMMCKgCDAjIAQwI6AAMCQgD9AkoAvQJSAL0C4T9DBQExgH0BNYA9ATmAXEAPIBMQBPgtEAVgrDZvuTmyu1cSoAVgFyDAS3ByAAAAQHcvAAAAAAAAAAAAwFF/hgoBAAAAALgH+Pj8+n57f22aValgAN3wbToA2XAdgGy4CkBKz3cvD4/3T02xVNfRvASz4ToA2XAdgPlicbszXAdgfnN9dXlx3s3QAciG6wBkw/UAmm0AAAAAAAAcruP5DDXbAAAAAAAAAAAAAA4UL0EAUk8AAAAAAAAA8MOuueRGCANB9AYGyR/ANgjvuP8JIw39Y+JdVilcGzK9q0fzcEYzAAwAA8AbAMzzy/8ZmucBYAAYAIAAtEB5BYB1c58cOkqOoqNIk4AHYHF3Th1lR1ll5GkCuAHTJt20LSXJqBIlRAD+1+12nPw92qdO/vtJkB/vIlZwHM+jQIMLEUBxdyIPLsfZvrUYEAGQBXW9dydZvrZkQgRAFtR9P52k0Oi4P56YANiCnTrxyWTHBMD7vbDwNMez4YUJgC0Y2IGa+nwvrJgA2IJRnndNeyCaMAGwBbMc+jTBPiQeFcBtQerX7g+0B5d9MWZUAHSDN+tA2vrdEkqoAPic15SGJzGctuAK+X2AkXxQB2YWg7Uk5hci9jWvRky89kGfCo8LgMpGvdsriyGpIzIugKy3mOQnf2R9CRRcAGTBqg6UVfC6IAsuALaglI16PJK/NtBvha0FA5ct9r432gVkAHLSWam1qq/wSyAiA8jcMem2F55d4kDUk6BY8CAS3hx/PNNZkAHQ5p/qQHFfpdk2IQPgCnQtVgytfi4HNgC24H1ZrBjYgdgAqOxj25OduYANIDkT/xBDvS8NG8DqTGKnV52wATw6FBGD5kAHYMsuIgZNRAdgym49MQR0AKas74mhoQMwZWOn2In7I6nfZUNHDDs+AC3bOmK48AFI2doTQ8AHIGWPnhiAfygpZas4UCMOfAGAPpXwSUlvBfCG3woPAH8OxklwABgABoAB4Ie9OzgBGISCKNhBsIP032UOYsDgRUhAs7MVyJz8pwcAAAAAAAAAmJ1jCEApAAAAAAAAQCzAMVjUT/AYDAAAAAAAAFgLID61FR9bk9sTXPwkubnPMTQXXT1zAeru3nAuQF1seLk8Fpze7hccX+8XnN8fDMAPAVYbAAAA2nsBAAAAAAAAAAAAAAAAAAAAAC8AbLL2XgAArvbggAQAAABA0P/X0Q8VAAAAABaPMFYsMqbIsgAAAABJRU5ErkJggg==",alt:"docx-icon.png"}):e.includes(".json")?Object(l.jsx)("img",{src:G,alt:"json-icon.png"}):e.includes(".xl")?Object(l.jsx)("img",{src:Z,alt:"excel-icon.png"}):Object(l.jsx)("img",{src:"",alt:"."}),Object(l.jsx)(T,{title:e.includes("pdf")?"Open PDF in new Tab":"Download File",children:Object(l.jsx)("button",{type:"button",className:"link-btn",onClick:function(){return function(e){s([{type:"isLoading",data:!0}]),R(e).then((function(e){return u=e.headers.get("Content-Disposition").replace("attachment; filename=: ",""),e.blob()})).then((function(e){if("application/pdf"===e.type){var t=new Blob([e],{type:"application/pdf"}),n=URL.createObjectURL(t);window.open(n)}else{var r,a=URL.createObjectURL(new Blob([e])),i=document.createElement("a");i.href=a,i.setAttribute("download",u),document.body.appendChild(i),i.click(),null===(r=i.parentNode)||void 0===r||r.removeChild(i)}s([{type:"isLoading",data:!1}])})).catch((function(e){console.log("Unable to retrieve file",e),P(s,"fail")}))}(e)},children:e})})]},t)})):Object(l.jsx)("div",{children:"Unable tor retreive any file for this Application number."})})]})})};function q(e){var t=Object(r.useContext)(U).toggleModal;return e.value?Object(l.jsx)(T,{title:"View All Files",children:Object(l.jsx)("button",{type:"button",className:"modal-open-link",onClick:function(){t(Object(l.jsx)(X,{applicationNumber:e.value,facilityId:e.data.facilityId}))},children:e.value})}):Object(l.jsx)("div",{children:"---"})}var K=function(e){return Object(l.jsx)(J,{showClearModal:!1,children:Object(l.jsx)(q,Object(d.a)({},e))})},_=function(e){if(!e)return"defaultCellRenderer";switch(e.columnType){case"url":return"urlRenderer";case"navigate":return"navigationRenderer";case"modal":return"modalRenderer";case"string":case"number":default:return"defaultCellRenderer"}},$=(n(208),n(163)),ee=n.n($),te=n(123),ne=n.n(te);var re=["facilityName","companyName","reason","description","finalPermitWaiverDocument"],ae={agColumnHeader:function(e){return Object(l.jsxs)("button",{type:"button",className:"header-btn",onClick:function(){e.sort(e.column.colId)},children:[Object(l.jsx)("div",{children:e.displayName}),e.sortable?Object(l.jsx)(T,{title:e.sortState.criteria===e.column.colId&&"DESC"===e.sortState.state?"Sort Ascending":"Sort Descending",children:Object(l.jsxs)("div",{className:"sort-icons",children:[e.sortState.criteria!==e.column.colId?Object(l.jsx)(ne.a,{className:"sortIcon"}):null,e.sortState.criteria===e.column.colId&&"DESC"===e.sortState.state?Object(l.jsx)(ee.a,{className:"sortIcon"}):null,e.sortState.criteria===e.column.colId&&"ASC"===e.sortState.state?Object(l.jsx)(ne.a,{className:"sortIcon"}):null]})}):null]})},defaultCellRenderer:x,urlRenderer:Q,navigationRenderer:M,modalRenderer:K};var ie=function(e){!function(){var e=Object(r.useRef)(),t=Object(r.useRef)(),n=Object(r.useRef)(!1),a=Object(r.useRef)({position:"",top:"",zIndex:""});Object(r.useEffect)((function(){e.current=document.querySelector('[ref="headerRoot"]'),t.current=document.querySelector('[ref="eBodyViewport"]');var n=e.current;a.current.position=n.style.position,a.current.top=n.style.top,a.current.zIndex=n.style.zIndex}),[]);var i=Object(r.useCallback)((function(){var r=e.current,i=t.current;if(r&&i){var o=!1,c=!1;if(n.current?(c=i.getBoundingClientRect().top-r.getBoundingClientRect().height+30>0)&&(n.current=!1):(o=r.getBoundingClientRect().top<=0)&&(n.current=!0),o&&(r.style.position="fixed",r.style.top="0",r.style.zIndex="2",r.style.width="initial"),c){var s=a.current;r.style.position=s.position,r.style.top=s.top,r.style.zIndex=s.zIndex}}}),[]);Object(r.useEffect)((function(){return window.addEventListener("scroll",i),function(){return window.removeEventListener("scroll",i)}}))}();var t=Object(r.useState)(),n=Object(b.a)(t,2),a=n[0],i=n[1];return Object(l.jsx)("div",{className:"ag-theme-alpine",style:{width:e.tableWidth},children:Object(l.jsx)(v.AgGridReact,{onGridReady:function(e){i(e.api)},onFirstDataRendered:function(e){null===a||void 0===a||a.sizeColumnsToFit()},rowData:e.rowData,domLayout:"autoHeight",animateRows:!0,frameworkComponents:ae,rowHeight:e.rowHeight,headerHeight:80,groupHeaderHeight:50,rowClassRules:{"alt-background":function(e){return e.node.rowIndex%2!==0}},children:Object.keys(e.colDefConfig).map((function(t){var n={headerName:e.colDefConfig[t].columnName,cellClass:"default-cell"};return e.colDefConfig[t].children?Object(l.jsx)(v.AgGridColumn,Object(d.a)(Object(d.a)({},n),{},{headerClass:"group-header",children:Object.keys(e.colDefConfig[t].children).map((function(r){var a,i,o;return n=Object(d.a)(Object(d.a)({},n),{},{headerName:null===(a=e.colDefConfig[t].children)||void 0===a?void 0:a[r].columnName,headerComponentParams:{sortable:null===(i=e.colDefConfig[t].children)||void 0===i?void 0:i[r].sortable,sortState:e.sortFilterState,sort:e.sort},headerClass:"default-header",field:r,cellRenderer:_(null===(o=e.colDefConfig[t].children)||void 0===o?void 0:o[r])}),re.includes(t)&&(n.suppressSizeToFit=!0),Object(l.jsx)(v.AgGridColumn,Object(d.a)({},n),r)}))}),t):(n=Object(d.a)(Object(d.a)({},n),{},{headerComponentParams:{sortable:e.colDefConfig[t].sortable,sortState:e.sortFilterState,sort:e.sort},headerClass:"default-header",field:t,cellRenderer:_(e.colDefConfig[t])}),re.includes(t)&&(n.width=250,n.suppressSizeToFit=!0),Object(l.jsx)(v.AgGridColumn,Object(d.a)({},n),t))}))})})};var oe=function(e){var t=Object(r.useState)({permitType:"facility",tableWidth:"96.6vw",colDefConfig:{},rowData:[],pageSize:0,sortFilterState:{criteria:"formerCompanyFacilityName",page:0,state:"ASC",search:""},rowHeight:void 0}),n=Object(b.a)(t,2),a=n[0],i=n[1],o=Object(r.useContext)(j),c=o.dispatch;return Object(r.useEffect)((function(){c([{type:"isLoading",data:!0}]),S(e.permitType,a.sortFilterState).then((function(e){i((function(t){return Object(d.a)(Object(d.a)({},t),{},{colDefConfig:e.columns,rowData:Object(g.a)(e.facilities.content),pageSize:e.facilities.totalPages})})),c([{type:"isLoading",data:!1}])})).catch((function(e){console.log("Facility Err",e),i((function(e){return Object(d.a)({},e)})),c([{type:"isLoading",data:!1}])}))}),[c,e.permitType,a.sortFilterState]),Object(l.jsxs)("div",{className:"table-container",children:[Object(l.jsx)("div",{className:"table-title",children:"Facilities"}),a.rowData.length?Object(l.jsx)("div",{children:Object(l.jsx)(ie,Object(d.a)(Object(d.a)({},a),{},{sort:function(e){i(F(e,a))}}))}):o.state.isLoading?null:Object(l.jsx)("div",{children:"No Facility Table Data"})]})},ce=n(164),se=(n(209),{"Air Permit":"Air_Permit","Storm Water Permit":"Storm_Water_Permit","Injection Well Permit":"Injection_Well_Permit","Water Wells/Reservoirs Permits":"Water_Reservoirs_Permit","EPA Class V Cathodic Protection":"EPA_Class_V_Cathodic_Protection","North & South Evap. Ponds":"North_&_South_Evap._Ponds_adarsh"}),le=["File Name","Facility Number"],ue=n(124),de=n(71),be=n(72),fe=n(179),je=n(115),pe=n(165),Ae=n(294),he=n(110),me=n(303),Oe=function(){function e(t,n){var r=this;Object(de.a)(this,e),this.blobStorage=t,this.blobState=n,this.downloadQueueInner$=new fe.a,this.downloadedItems$=this.downloadQueue$.pipe(Object(pe.a)((function(e){return r.downloadFile(e)}))),this.downloadFile=function(e){return r.blobState.getStorageOptionsWithContainer().pipe(Object(Ae.a)((function(t){return r.blobStorage.downloadBlobItem(Object(d.a)(Object(d.a)({},t),{},{filename:e})).pipe(r.getDownloadUrlFromResponse(),r.mapDownloadResponse(e,t))})))},this.mapDownloadResponse=function(e,t){return function(n){return n.pipe(Object(he.a)((function(n){return{filename:e,containerName:t.containerName,url:n}})),Object(me.a)({filename:e,containerName:t.containerName,url:""}))}},this.getDownloadUrlFromResponse=function(){return function(e){return e.pipe(Object(Ae.a)((function(e){return Object(je.a)(e.blobBody?e.blobBody:Promise.resolve({})).pipe(Object(he.a)((function(e){return window.URL.createObjectURL(e)})))})))}}}return Object(be.a)(e,[{key:"downloadQueue$",get:function(){return this.downloadQueueInner$.asObservable()}},{key:"downloadItem",value:function(e){this.downloadQueueInner$.next(e)}}]),e}(),ge=n(101),ve=n(295),xe=n(296),Ce=n(297),we=n(298),ye=function(){function e(t){var n=this;Object(de.a)(this,e),this.blobStorage=t,this.selectedContainerInner$=new ve.a(""),this.containers$=this.blobStorage.getContainers(this.getStorageOptions()),this.itemsInContainer$=this.selectedContainer$.pipe(Object(xe.a)((function(e){return!!e})),Object(Ae.a)((function(e){return n.blobStorage.listBlobsInContainer(Object(d.a)(Object(d.a)({},n.getStorageOptions()),{},{containerName:e}))}))),this.finaliseBlobChange=function(e){return function(t){return t.pipe(Object(Ce.a)((function(){return n.selectedContainerInner$.value===e&&n.selectedContainerInner$.next(e)})))}},this.scanEntries=function(){return function(e){return e.pipe(Object(he.a)((function(e){return Object(ge.a)({},"".concat(e.containerName,"-").concat(e.filename),e)})),Object(we.a)((function(e,t){return Object(d.a)(Object(d.a)({},e),t)}),{}),Object(he.a)((function(e){return Object.values(e)})))}}}return Object(be.a)(e,[{key:"selectedContainer$",get:function(){return this.selectedContainerInner$.asObservable()}},{key:"getContainerItems",value:function(e){this.selectedContainerInner$.next(e)}},{key:"getStorageOptionsWithContainer",value:function(){var e=this;return this.selectedContainer$.pipe(Object(he.a)((function(t){return Object(d.a)(Object(d.a)({},e.getStorageOptions()),{},{containerName:t})})))}},{key:"getStorageOptions",value:function(){return{storageUri:"https://bridgei2i.blob.core.windows.net/?sv=2020-02-10&ss=b&srt=sco&sp=rwdlacx&se=2021-10-26T16:48:00Z&st=2021-03-26T08:48:00Z&spr=https&sig=%2FLc1Wdf5BfR1I9rrDNlja0EJ1zBGCF7yn7vXNW1xC%2Bg%3D",storageAccessToken:"?sv=2020-02-10&ss=b&srt=sco&sp=rwdlacx&se=2021-10-26T16:48:00Z&st=2021-03-26T08:48:00Z&spr=https&sig=%2FLc1Wdf5BfR1I9rrDNlja0EJ1zBGCF7yn7vXNW1xC%2Bg%3D"}}}]),e}(),Ie=n(166),Be=n(301),Se=n(26),Ne=n(300),ke=new(function(){function e(){Object(de.a)(this,e),this.buildConnectionString=function(e){return"BlobEndpoint=".concat(e.storageUri,";")+"SharedAccessSignature=".concat(e.storageAccessToken)}}return Object(be.a)(e,[{key:"getContainers",value:function(e){var t=this.buildClient(e);return this.asyncToObservable(t.listContainers())}},{key:"listBlobsInContainer",value:function(e){var t=this.getContainerClient(e);return this.asyncToObservable(t.listBlobsFlat())}},{key:"downloadBlobItem",value:function(e){var t=this.getBlockBlobClient(e);return Object(je.a)(t.download())}},{key:"deleteBlobItem",value:function(e){var t=this.getBlockBlobClient(e);return Object(je.a)(t.delete())}},{key:"uploadToBlobStorage",value:function(e,t){var n=this.getBlockBlobClient(t);return this.uploadFile(n,e)}},{key:"getBlockBlobClient",value:function(e){return this.getContainerClient(e).getBlockBlobClient(e.filename)}},{key:"getContainerClient",value:function(e){return this.buildClient(e).getContainerClient(e.containerName)}},{key:"buildClient",value:function(e){return Be.a.fromConnectionString(this.buildConnectionString(e))}},{key:"uploadFile",value:function(e,t){var n=this;return new Se.a((function(r){e.uploadBrowserData(t,{onProgress:n.onProgress(r),blobHTTPHeaders:{blobContentType:t.type}}).then(n.onUploadComplete(r,t),n.onUploadError(r))})).pipe(Object(Ne.a)())}},{key:"onUploadError",value:function(e){return function(t){return e.error(t)}}},{key:"onUploadComplete",value:function(e,t){return function(){e.next(t.size),e.complete()}}},{key:"onProgress",value:function(e){return function(t){return e.next(t.loadedBytes)}}},{key:"asyncToObservable",value:function(e){return new Se.a((function(t){Object(y.a)(w.a.mark((function n(){var r,a,i,o,c,s,l;return w.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:n.prev=0,r=!0,a=!1,n.prev=3,o=Object(Ie.a)(e);case 5:return n.next=7,o.next();case 7:return c=n.sent,r=c.done,n.next=11,c.value;case 11:if(s=n.sent,r){n.next=20;break}if(l=s,!t.closed){n.next=16;break}return n.abrupt("return");case 16:t.next(l);case 17:r=!0,n.next=5;break;case 20:n.next=26;break;case 22:n.prev=22,n.t0=n.catch(3),a=!0,i=n.t0;case 26:if(n.prev=26,n.prev=27,r||null==o.return){n.next=31;break}return n.next=31,o.return();case 31:if(n.prev=31,!a){n.next=34;break}throw i;case 34:return n.finish(31);case 35:return n.finish(26);case 36:t.complete(),n.next=42;break;case 39:n.prev=39,n.t1=n.catch(0),t.error(n.t1);case 42:case"end":return n.stop()}}),n,null,[[0,39],[3,22,26,36],[27,,31,35]])})))()})).pipe(Object(we.a)((function(e,t){return[].concat(Object(g.a)(e),[t])}),[]),Object(me.a)([]))}}]),e}()),Re=new ye(ke),De=new Oe(ke,Re),Fe=Object(r.createContext)(Re),Pe=Object(r.createContext)(De),Ee=(n(254),n(174)),Le=n.n(Ee);var Te=function(e){return Object(l.jsx)("div",{className:"notifier-container".concat("start"===e.show?" notifier-start slideIn":"end"===e.show?" notifier-end slideOut":"").concat("success"===e.type?" notify-success":"fail"===e.type?" notify-fail":""),children:"success"===e.type?Object(l.jsxs)(r.Fragment,{children:[Object(l.jsx)(Le.a,{}),"File downloaded Successfully."]}):"fail"===e.type?Object(l.jsxs)(r.Fragment,{children:[Object(l.jsx)(Y.a,{}),"File currently not available."]}):null})},Qe=(n(255),function(e,t){return Object(l.jsx)("thead",{children:Object(l.jsx)("tr",{children:t.map((function(t,n){return Object(l.jsx)("th",{children:t},"".concat(e,"-header-").concat(n))}))})})});var Ue=function(e){var t=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=Object(r.useState)(e),n=Object(b.a)(t,2),a=n[0],i=n[1],o=Object(r.useRef)(null),c=Object(r.useCallback)((function(e){var t=e.top,n=e.bottom;t<=0&&n>250?!a&&i(!0):a&&i(!1)}),[a]);return Object(r.useEffect)((function(){var e=function(){c(o.current.getBoundingClientRect())};return window.addEventListener("scroll",e),function(){window.removeEventListener("scroll",e)}}),[c]),{tableRef:o,isSticky:a}}(),n=t.tableRef,a=t.isSticky;return Object(l.jsxs)("div",{children:[a&&Object(l.jsx)("table",{className:"sticky-header",children:Qe(e.data.tableName,e.data.columns)}),Object(l.jsxs)("table",{ref:n,children:[Qe(e.data.tableName,e.data.columns),Object(l.jsx)("tbody",{children:e.data.rows.map((function(t,n){return t.length?Object(l.jsx)("tr",{children:e.data.columns.map((function(n,r){return Object(l.jsx)("td",{children:t[r]?e.data.actionableColumnIndexes.includes(r)?Object(l.jsx)("button",{type:"button",className:"download-btn",onClick:function(){return e.setFileToDownload(t[r])},children:t[r]}):t[r]:null},"".concat(e.data.tableName,"-cell-").concat(r))}))},"".concat(e.data.tableName,"-row-").concat(n)):null}))})]})]})},Me=function(e){return e.reduce((function(e,t,n){for(var r=!1,a=0;a<le.length;a++)if(t.includes(le[a])){r=!0;break}return r&&e.push(n),e}),[])};var We=function(e){var t=Object(r.useContext)(j),n=t.dispatch,a=Object(r.useContext)(Pe),i=Object(r.useState)({tableName:"",columns:[],rows:[],actionableColumnIndexes:[]}),o=Object(b.a)(i,2),c=o[0],s=o[1];return Object(r.useEffect)((function(){fetch("./".concat(se[e.permitType],".xlsx")).then((function(e){return e.blob()})).then((function(e){var t=e,n=new FileReader;n.onload=function(e){var t,n=null===e||void 0===e||null===(t=e.target)||void 0===t?void 0:t.result,r=ue.read(n,{type:"binary"}),a=r.SheetNames[0],i=r.Sheets[a],o=ue.utils.sheet_to_json(i,{header:1});if(o.length>=2){var c=o,l=Object(ce.a)(c),u=l[0],d=l.slice(1),b=u.map((function(e){return function(e){if(null==e||""===e)return e;e=e.trim();for(var t="",n=0;n<e.length;n++)/[A-Z]/.test(e[n])&&0!==n&&/[a-z]/.test(e[n-1])&&(t+=" "),0===n&&/[a-z]/.test(e[n])?t+=e[n].toUpperCase():t+=e[n];return t}(e.replace(/\s\s+/g," "))}));s({tableName:a,columns:b,rows:d,actionableColumnIndexes:Me(b)}),console.log("Data \n",u,d)}},n.readAsBinaryString(t)}))}),[e.permitType]),Object(r.useEffect)((function(){var e=a.downloadedItems$.subscribe((function(e){e.filename&&e.url&&(console.log("FiletoDownload",e),e.filename.includes(".pdf")?window.open(e.url):function(e,t){var n,r=document.createElement("a");r.href=t,r.setAttribute("download",e),document.body.appendChild(r),r.click(),null===(n=r.parentNode)||void 0===n||n.removeChild(r)}(e.filename.split("/").pop(),e.url),P(n,"success"))}),(function(e){console.log("Err",e),P(n,"fail")}));return function(){return e.unsubscribe()}}),[n,a.downloadedItems$]),c.columns.length&&c.rows.length?Object(l.jsxs)(r.Fragment,{children:[Object(l.jsx)("div",{className:"excel-viewer-container",children:Object(l.jsx)(Ue,{data:c,setFileToDownload:function(e){!function(e){n([{type:"isLoading",data:!0}]);var t=JSON.parse(sessionStorage.getItem("BlobData")).blobList.find((function(t){return t.includes(e)}));console.log("Found FIleName",t),t?a.downloadItem(t):P(n,"fail")}(e)}})}),Object(l.jsx)(Te,Object(d.a)({},t.state.showNotifier))]}):Object(l.jsx)("div",{children:"No Table Data Available"})};var He=function(){var e=Object(r.useContext)(Fe),t=Object(r.useContext)(Fe),n=Object(r.useState)(O[0].name),a=Object(b.a)(n,2),i=a[0],o=a[1];return Object(r.useEffect)((function(){e.getContainerItems("bpx-permits")}),[e]),Object(r.useEffect)((function(){var e=t.itemsInContainer$.subscribe((function(e){var t={date:(new Date).toDateString(),blobList:e.map((function(e){return e.name}))};sessionStorage.setItem("BlobData",JSON.stringify(t))}));return function(){return e.unsubscribe()}}),[t.itemsInContainer$]),Object(l.jsxs)("div",{className:"home-wrapper",children:[Object(l.jsx)(h,{options:O,handleRadioButtonToggle:function(e){o(e.target.value)},selected:i}),Object(l.jsx)("div",{className:"table-wrapper",children:"Air Permit"===i?Object(l.jsx)(oe,{permitType:i}):Object(l.jsx)(We,{permitType:i})})]})};var Ye=function(){var e=Object(c.f)(),t=e.facilityId,n=e.permitId,a=e.fileName,i=Object(r.useState)(),o=Object(b.a)(i,2),s=o[0],u=o[1];return Object(r.useEffect)((function(){t&&n&&k(t,n).then((function(e){var t=new Blob([e],{type:"application/pdf"}),n=URL.createObjectURL(t);u(n)})),a&&R(a).then((function(e){var t=new Blob([e],{type:"application/pdf"}),n=URL.createObjectURL(t);u(n)}))}),[t,a,n]),s?Object(l.jsx)("div",{children:Object(l.jsx)("iframe",{style:{width:"99.6vw",height:"98.7vh"},src:s,"data-type":"application/pdf",title:"title"})}):Object(l.jsx)("div",{children:"Loading..."})},Ve=(n(257),n(175)),ze=n.n(Ve);var Je=function(){var e=Object(c.f)().facilityId,t=Object(r.useState)({tableWidth:"96.6vw",permitType:"permit",colDefConfig:{},rowData:[],sortFilterState:{criteria:"permitNumber",page:0,state:"ASC",search:""},rowHeight:100}),n=Object(b.a)(t,2),a=n[0],i=n[1],s=Object(r.useContext)(j),u=s.dispatch;return Object(r.useEffect)((function(){u([{type:"isLoading",data:!0}]),N(e,a.sortFilterState).then((function(e){i((function(t){return Object(d.a)(Object(d.a)({},t),{},{colDefConfig:e.columns,rowData:Object(g.a)(e.permits)})})),u([{type:"isLoading",data:!1}])})).catch((function(e){console.log("Permit Err",e),u([{type:"isLoading",data:!1}])}))}),[u,e,a.sortFilterState]),Object(l.jsxs)(r.Fragment,{children:[Object(l.jsx)("div",{className:"permit-table-wrapper",children:Object(l.jsxs)("div",{className:"table-container",children:[Object(l.jsx)(T,{title:"Back",children:Object(l.jsx)(o.b,{to:"/",className:"back-btn",children:Object(l.jsx)(ze.a,{})})}),Object(l.jsx)("div",{className:"table-title",children:"Permits"}),a.rowData.length?Object(l.jsx)("div",{children:Object(l.jsx)(ie,Object(d.a)(Object(d.a)({},a),{},{sort:function(e){i(F(e,a))}}))}):s.state.isLoading?null:Object(l.jsx)("div",{children:"No Permit Table Data"})]})}),Object(l.jsx)(Te,Object(d.a)({},s.state.showNotifier))]})};var Ze=function(){var e=Object(r.useContext)(j);return Object(l.jsxs)(r.Fragment,{children:[e.state.isLoading&&Object(l.jsx)(u,{}),Object(l.jsx)(o.a,{children:Object(l.jsxs)(c.c,{children:[Object(l.jsx)(c.a,{exact:!0,path:"/",component:He}),Object(l.jsx)(c.a,{exact:!0,path:"/permits/:facilityId",component:Je}),Object(l.jsx)(c.a,{exact:!0,path:"/pdf/:facilityId/:permitId",component:Ye}),Object(l.jsx)(c.a,{exact:!0,path:"/pdfByFileName/:fileName",component:Ye})]})})]})},Ge=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,305)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,i=t.getLCP,o=t.getTTFB;n(e),r(e),a(e),i(e),o(e)}))};i.a.render(Object(l.jsx)(A,{children:Object(l.jsx)(Ze,{})}),document.getElementById("root")),Ge()}},[[258,1,2]]]);
//# sourceMappingURL=main.3e29ac05.chunk.js.map